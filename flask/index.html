<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120656861-1"></script>
  <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
   gtag('config', 'UA-120656861-1');
  </script>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />


  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#00aba9">
  <meta name="theme-color" content="#ffffff">

  <title>flask</title>

  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>

  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <link rel="stylesheet" href="/_css/content.css" />


  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->

  <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed|Roboto+Mono" rel="stylesheet">
</head>
<body>
<nav class="menu">
  <ol class="breadcrumb">
    <li><a href="/" >Home</a></li>
    <li>flask</li>
  </ol>
</nav>

<article>
<header>
<h1 class="title">flask</h1>
</header>

<nav class="toc">
<h2>Table of Contents</h2>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#reference">Reference</a><ul>
<li><a href="#config">Config</a></li>
<li><a href="#flask-1">Flask</a></li>
<li><a href="#g">g</a></li>
<li><a href="#jsonify">jsonify</a></li>
<li><a href="#openresource">open<sub>resource</sub></a></li>
<li><a href="#redirect">redirect</a></li>
<li><a href="#rendertemplate">render<sub>template</sub></a></li>
<li><a href="#request">request</a></li>
<li><a href="#multidict">MultiDict</a></li>
<li><a href="#route">route</a></li>
<li><a href="#urlfor">url<sub>for</sub></a></li>
<li><a href="#testclient">test<sub>client</sub></a></li>
</ul></li>
<li><a href="#topics">Topics</a><ul>
<li><a href="#application-context">Application Context</a></li>
<li><a href="#blueprints">Blueprints</a><ul>
<li><a href="#access-config-within-blueprints">Access config within Blueprints</a></li>
</ul></li>
<li><a href="#commands">Commands</a></li>
<li><a href="#cookies">Cookies</a></li>
<li><a href="#http-methods">HTTP Methods</a></li>
<li><a href="#message-flashing">Message Flashing</a></li>
<li><a href="#redirects-and-errors">Redirects and Errors</a></li>
<li><a href="#request-context">Request Context</a></li>
<li><a href="#responses">Responses</a></li>
<li><a href="#routing">Routing</a></li>
<li><a href="#sessions">Sessions</a></li>
<li><a href="#signals">Signals</a></li>
<li><a href="#static-files">Static Files</a></li>
<li><a href="#templates">Templates</a><ul>
<li><a href="#standard-contexts">Standard Contexts</a></li>
<li><a href="#tojson">tojson</a></li>
</ul></li>
</ul></li>
<li><a href="#patterns">Patterns</a><ul>
<li><a href="#application-factories">Application Factories</a></li>
</ul></li>
<li><a href="#extensions">Extensions</a><ul>
<li><a href="#flask-cors">flask-cors</a></li>
</ul></li>
</ul>
</nav>

<h1 id="overview">Overview</h1>
<pre class="example"><code>/&lt;project-root&gt;
  /&lt;package&gt;
    __init__.py
    /static
    /templates
  setup.py
  MANIFEST.in
</code></pre>
<p><code>setup.py</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="im">from</span> setuptools <span class="im">import</span> setup</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">setup(</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    name<span class="op">=</span><span class="st">&#39;flaskr&#39;</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    packages<span class="op">=</span>[<span class="st">&#39;flaskr&#39;</span>],</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    include_package_data<span class="op">=</span><span class="va">True</span>,</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">    install_requires<span class="op">=</span>[</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">        <span class="st">&#39;flask&#39;</span>,</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">    ],</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">    setup_requires<span class="op">=</span>[</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">        <span class="st">&#39;pytest-runner&#39;</span>,</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">    ],</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">    tests_require<span class="op">=</span>[</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">        <span class="st">&#39;pytest&#39;</span>,</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">    ],</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">)</a></code></pre></div>
<h1 id="reference">Reference</h1>
<h2 id="config">Config</h2>
<ul>
<li>Load from a <code>.cfg</code> file</li>
<li>The configuration files themselves are actual Python files.</li>
<li>Only values in uppercase are actually stored in the config object later on.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" data-line-number="1">app.config.from_pyfile(<span class="st">&#39;yourconfig.cfg&#39;</span>)</a></code></pre></div>
<ul>
<li>Load from the current python module</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Only uppercase keys are added to the config</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">DEBUG <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">SECRET_KEY <span class="op">=</span> <span class="st">&#39;development key&#39;</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">app.config.from_object(<span class="va">__name__</span>)</a></code></pre></div>
<ul>
<li>Load from a file of which name is specified by env</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb5-1" data-line-number="1">export YOURAPPLICATION_SETTINGS<span class="op">=</span><span class="st">&#39;/path/to/config/file&#39;</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">app.config.from_envvar(<span class="st">&#39;YOURAPPLICATION_SETTINGS&#39;</span>)</a></code></pre></div>
<p>Certain configuration values are also forwarded to the Flask object so you can read and write them from there:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb6-1" data-line-number="1">app <span class="op">=</span> Flask(<span class="va">__name__</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">app.config[<span class="st">&#39;DEBUG&#39;</span>] <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># equivalent to above</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">app.debug <span class="op">=</span> <span class="va">True</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb7-1" data-line-number="1">app <span class="op">=</span> Flask(<span class="va">__name__</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">app.config.from_object(<span class="st">&#39;yourapplication.default_settings&#39;</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">app.config.from_envvar(<span class="st">&#39;YOURAPPLICATION_SETTINGS&#39;</span>) <span class="co"># overrides</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">app.config.from_mapping({<span class="st">&#39;ABC&#39;</span>: <span class="st">&#39;test&#39;</span>})</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Config" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Config</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/config/#builtin-configuration-values" class="uri">http://flask.pocoo.org/docs/0.12/config/#builtin-configuration-values</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Flask.default_config" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Flask.default_config</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Config.from_mapping" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Config.from_mapping</a></li>
</ul>
</div>
<h2 id="flask-1">Flask</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb8-1" data-line-number="1">app <span class="op">=</span> Flask(<span class="st">&#39;yourapplication&#39;</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">app <span class="op">=</span> Flask(<span class="va">__name__</span>.split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>])</a></code></pre></div>
<blockquote>
<p>If you are using a single module, <code>name</code> is always the correct value. If you however are using a package, it’s usually recommended to <strong>hardcode the name of your package</strong> there.</p>
</blockquote>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#application-object" class="uri">http://flask.pocoo.org/docs/0.12/api/#application-object</a></li>
</ul>
</div>
<h2 id="g">g</h2>
<blockquote>
<p>Stored on the application context and no longer on the request context which means it becomes available if only the application context is bound and not yet a request.</p>
</blockquote>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.g" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.g</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/tutorial/dbcon/" class="uri">http://flask.pocoo.org/docs/0.12/tutorial/dbcon/</a></li>
</ul>
</div>
<h2 id="jsonify">jsonify</h2>
<pre class="example"><code>flask.json.jsonify(*args, **kwargs)
</code></pre>
<ol>
<li>Dumps the arguments. Pack multipe arugments as <code>args</code> into JSON array, <code>kwargs</code> into JSON object.</li>
<li>Create <code>Response</code> object with <code>Content-Type</code> of <code>application/json</code></li>
</ol>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.json.jsonify" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.json.jsonify</a></li>
</ul>
</div>
<h2 id="openresource">open<sub>resource</sub></h2>
<pre class="example"><code>/myapplication.py
/schema.sql
/static
    /style.css
/templates
    /layout.html
    /index.html
</code></pre>
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Flask" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Flask</a></li>
</ul>
<blockquote>
<p>The name of the package is used to resolve resources from inside the package or the folder the module is contained in</p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="cf">with</span> app.open_resource(<span class="st">&#39;schema.sql&#39;</span>) <span class="im">as</span> f:</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">    contents <span class="op">=</span> f.read()</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">    do_something_with(contents)</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Flask.open_resource" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Flask.open_resource</a></li>
</ul>
</div>
<h2 id="redirect">redirect</h2>
<pre class="example"><code>flask.redirect(location, code=302, Response=None)
</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="at">@app.route</span>(<span class="st">&#39;/&#39;</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">def</span> index():</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">    <span class="cf">return</span> redirect(url_for(<span class="st">&#39;login&#39;</span>))</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.10/api/#flask.redirect" class="uri">http://flask.pocoo.org/docs/0.10/api/#flask.redirect</a></li>
</ul>
</div>
<h2 id="rendertemplate">render<sub>template</sub></h2>
<pre class="example"><code>flask.render_template(template_name_or_list, **context)
</code></pre>
<dl>
<dt>context</dt>
<dd>the variables that should be available in the context of the template.
</dd>
</dl>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.render_template" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.render_template</a></li>
</ul>
</div>
<h2 id="request">request</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># A MultiDict with the parsed contents of the query string.(The part in the URL after the question mark).</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">request.args.get(<span class="st">&#39;value&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)</a></code></pre></div>
<p>Use <code>request.get_json()</code>, which is later added for consistency, instead of <code>request.json</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># force  if set to True the mimetype is ignored.</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># silent if set to True this method will fail silently and return None.</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co"># cache  if set to True the parsed JSON data is remembered on the request.</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">request.get_json(force<span class="op">=</span><span class="va">False</span>, silent<span class="op">=</span><span class="va">False</span>, cache<span class="op">=</span><span class="va">True</span>)</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Request" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Request</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Request.args" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Request.args</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Request.get_json" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Request.get_json</a></li>
</ul>
</div>
<h2 id="multidict">MultiDict</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="op">&gt;&gt;&gt;</span> d <span class="op">=</span> TypeConversionDict(foo<span class="op">=</span><span class="st">&#39;42&#39;</span>, bar<span class="op">=</span><span class="st">&#39;blub&#39;</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="op">&gt;&gt;&gt;</span> d.get(<span class="st">&#39;foo&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="dv">42</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="op">&gt;&gt;&gt;</span> d.get(<span class="st">&#39;bar&#39;</span>, <span class="dv">-1</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="dv">-1</span></a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://werkzeug.pocoo.org/docs/0.12/datastructures/#werkzeug.datastructures.MultiDict" class="uri">http://werkzeug.pocoo.org/docs/0.12/datastructures/#werkzeug.datastructures.MultiDict</a></li>
</ul>
</div>
<h2 id="route">route</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="at">@app.route</span>(<span class="st">&#39;/users/&#39;</span>, defaults<span class="op">=</span>{<span class="st">&#39;page&#39;</span>: <span class="dv">1</span>})</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="at">@app.route</span>(<span class="st">&#39;/users/page/&lt;int:page&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="kw">def</span> show_users(page):</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">    <span class="cf">pass</span></a></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td>rule</td>
<td>the URL rule as string</td>
</tr>
<tr class="even">
<td>endpoint</td>
<td>the endpoint for the registered URL rule. Flask itself assumes that the name of the view function is the name of the endpoint if not explicitly stated.</td>
</tr>
<tr class="odd">
<td>view<sub>func</sub></td>
<td>the function to call when serving a request to the provided endpoint. If this is not provided one can specify the function later by storing it in the view<sub>functions</sub> dictionary with the endpoint as key.</td>
</tr>
<tr class="even">
<td>defaults</td>
<td>A dictionary with defaults for this rule. See the example above for how defaults work.</td>
</tr>
<tr class="odd">
<td>subdomain</td>
<td>specifies the rule for the subdomain in case subdomain matching is in use. If not specified the default subdomain is assumed.</td>
</tr>
<tr class="even">
<td>**options</td>
<td>the options to be forwarded to the underlying Rule object. A change to Werkzeug is handling of method options. methods is a list of methods this rule should be limited to (GET, POST etc.). By default a rule just listens for GET (and implicitly HEAD). Starting with Flask 0.6, OPTIONS is implicitly added and handled by the standard request handling. They have to be specified as keyword arguments.</td>
</tr>
</tbody>
</table>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Flask.route" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Flask.route</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#url-route-registrations" class="uri">http://flask.pocoo.org/docs/0.12/api/#url-route-registrations</a></li>
<li><a href="http://werkzeug.pocoo.org/docs/0.14/routing/#werkzeug.routing.Rule" class="uri">http://werkzeug.pocoo.org/docs/0.14/routing/#werkzeug.routing.Rule</a></li>
</ul>
</div>
<h2 id="urlfor">url<sub>for</sub></h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb19-1" data-line-number="1">flask.url_for(endpoint, <span class="op">**</span>values)</a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb20-1" data-line-number="1">url_for(<span class="st">&#39;static&#39;</span>, filename<span class="op">=</span><span class="st">&#39;style.css&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># relative to current Blueprint</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">url_for(<span class="st">&#39;.index&#39;</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co"># Generate absolute URL</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5">url_for(<span class="st">&#39;.index&#39;</span>, _external<span class="op">=</span><span class="va">True</span>)</a></code></pre></div>
<p>Generates a URL to the given endpoint with the method provided. This is better than hard-coded URLs as following reasons:</p>
<ol>
<li>Reversing is often more descriptive</li>
<li>URL building will handle escaping</li>
<li>If your application is placed outside the URL root</li>
</ol>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.url_for" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.url_for</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#url-building" class="uri">http://flask.pocoo.org/docs/0.12/quickstart/#url-building</a></li>
</ul>
</div>
<h2 id="testclient">test<sub>client</sub></h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># propgate excetions to test_client</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">app.testing <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">client <span class="op">=</span> app.test_client()</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co"># keep client open until the end of with block to test with contexts</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co"># You can now read the session or other context variables</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="cf">with</span> app.test_client() <span class="im">as</span> c:</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">    <span class="cf">pass</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co"># If you want to modify the current session</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="co"># Use session_transaction() as following:</span></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="cf">with</span> client.session_transaction() <span class="im">as</span> sess:</a>
<a class="sourceLine" id="cb22-13" data-line-number="13">    sess.update(d)</a></code></pre></div>
<p><strong>test<sub>client</sub> DOES NOT support dict-json</strong>. You have to manually serialize dict to json and specify <code>content_type</code> as follows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb23-1" data-line-number="1">client.post(url,</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">            content_type<span class="op">=</span><span class="st">&#39;application/json&#39;</span>,</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">            data<span class="op">=</span>json.dumps(d))</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://werkzeug.pocoo.org/docs/0.14/test/#werkzeug.test.EnvironBuilder">Request parameters</a></li>
<li><a href="http://werkzeug.pocoo.org/docs/0.14/wrappers/#werkzeug.wrappers.BaseResponse">Response reference</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/testing/" class="uri">http://flask.pocoo.org/docs/0.12/testing/</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Flask.test_client" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Flask.test_client</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.testing.FlaskClient" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.testing.FlaskClient</a></li>
<li><a href="http://werkzeug.pocoo.org/docs/0.14/test/#werkzeug.test.Client" class="uri">http://werkzeug.pocoo.org/docs/0.14/test/#werkzeug.test.Client</a></li>
</ul>
</div>
<h1 id="topics">Topics</h1>
<h2 id="application-context">Application Context</h2>
<ul>
<li>Since one of the pillars of Flask’s design is that you can have more than one application in the same Python process.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="im">from</span> flask <span class="im">import</span> Flask, current_app</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"></a>
<a class="sourceLine" id="cb24-3" data-line-number="3">app <span class="op">=</span> Flask(<span class="va">__name__</span>)</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="cf">with</span> app.app_context():</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">    <span class="co"># within this block, current_app points to app.</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6">    <span class="bu">print</span> current_app.name</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="im">import</span> sqlite3</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="im">from</span> flask <span class="im">import</span> g</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="kw">def</span> get_db():</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">    db <span class="op">=</span> <span class="bu">getattr</span>(g, <span class="st">&#39;_database&#39;</span>, <span class="va">None</span>)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">    <span class="cf">if</span> db <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">        db <span class="op">=</span> g._database <span class="op">=</span> connect_to_database()</a>
<a class="sourceLine" id="cb25-8" data-line-number="8">    <span class="cf">return</span> db</a>
<a class="sourceLine" id="cb25-9" data-line-number="9"></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="at">@app.teardown_appcontext</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="kw">def</span> teardown_db(exception):</a>
<a class="sourceLine" id="cb25-12" data-line-number="12">    db <span class="op">=</span> <span class="bu">getattr</span>(g, <span class="st">&#39;_database&#39;</span>, <span class="va">None</span>)</a>
<a class="sourceLine" id="cb25-13" data-line-number="13">    <span class="cf">if</span> db <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb25-14" data-line-number="14">        db.close()</a>
<a class="sourceLine" id="cb25-15" data-line-number="15"></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="im">from</span> werkzeug.local <span class="im">import</span> LocalProxy</a>
<a class="sourceLine" id="cb25-17" data-line-number="17">db <span class="op">=</span> LocalProxy(get_db)</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/appcontext/" class="uri">http://flask.pocoo.org/docs/0.12/appcontext/</a></li>
</ul>
</div>
<h2 id="blueprints">Blueprints</h2>
<pre class="example"><code>flask.Blueprint(name, import_name, ...)
</code></pre>
<dl>
<dt><code>name</code></dt>
<dd>Use as the prefix of the blueprint routes
</dd>
<dt><code>import_name</code></dt>
<dd>Same as <code>Flask</code>, used for resolve the relative path for resources.
</dd>
</dl>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="im">from</span> flask <span class="im">import</span> Blueprint, render_template, abort</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="im">from</span> jinja2 <span class="im">import</span> TemplateNotFound</a>
<a class="sourceLine" id="cb27-3" data-line-number="3"></a>
<a class="sourceLine" id="cb27-4" data-line-number="4">simple_page <span class="op">=</span> Blueprint(<span class="st">&#39;simple_page&#39;</span>, <span class="va">__name__</span>,</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">                        template_folder<span class="op">=</span><span class="st">&#39;templates&#39;</span>)</a>
<a class="sourceLine" id="cb27-6" data-line-number="6"></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="at">@simple_page.route</span>(<span class="st">&#39;/&#39;</span>, defaults<span class="op">=</span>{<span class="st">&#39;page&#39;</span>: <span class="st">&#39;index&#39;</span>})</a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="at">@simple_page.route</span>(<span class="st">&#39;/&lt;page&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="kw">def</span> show(page):</a>
<a class="sourceLine" id="cb27-10" data-line-number="10">    <span class="cf">try</span>:</a>
<a class="sourceLine" id="cb27-11" data-line-number="11">        <span class="cf">return</span> render_template(<span class="st">&#39;pages/</span><span class="sc">%s</span><span class="st">.html&#39;</span> <span class="op">%</span> page)</a>
<a class="sourceLine" id="cb27-12" data-line-number="12">    <span class="cf">except</span> TemplateNotFound:</a>
<a class="sourceLine" id="cb27-13" data-line-number="13">        abort(<span class="dv">404</span>)</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="im">from</span> flask <span class="im">import</span> Flask</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="im">from</span> yourapplication.simple_page <span class="im">import</span> simple_page</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"></a>
<a class="sourceLine" id="cb28-4" data-line-number="4">app <span class="op">=</span> Flask(<span class="va">__name__</span>)</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">app.register_blueprint(simple_page)</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">app.register_blueprint(simple_page, url_prefix<span class="op">=</span><span class="st">&#39;/pages&#39;</span>)</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/blueprints/" class="uri">http://flask.pocoo.org/docs/0.12/blueprints/</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#flask.Blueprint" class="uri">http://flask.pocoo.org/docs/0.12/api/#flask.Blueprint</a></li>
</ul>
</div>
<h3 id="access-config-within-blueprints">Access config within Blueprints</h3>
<p>Use <code>flask.current_app</code>, but be careful that <code>current_app</code> is only accessible under the request context.:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="im">from</span> flask <span class="im">import</span> current_app <span class="im">as</span> app</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="at">@api.route</span>(<span class="st">&#39;/info/&#39;</span>, methods <span class="op">=</span> [<span class="st">&#39;GET&#39;</span>])</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="kw">def</span> get_account_num():</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">    num <span class="op">=</span> app.config[<span class="st">&quot;INFO&quot;</span>]</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://stackoverflow.com/questions/18214612/how-to-access-app-config-in-a-blueprint" class="uri">https://stackoverflow.com/questions/18214612/how-to-access-app-config-in-a-blueprint</a></li>
</ul>
</div>
<h2 id="commands">Commands</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="at">@app.cli.command</span>(<span class="st">&#39;initdb&#39;</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">def</span> initdb_command():</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">    <span class="cf">pass</span></a></code></pre></div>
<pre class="shell"><code>$ flask initdb
</code></pre>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/tutorial/dbinit/#tutorial-dbinit" class="uri">http://flask.pocoo.org/docs/0.12/tutorial/dbinit/#tutorial-dbinit</a></li>
</ul>
</div>
<h2 id="cookies">Cookies</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb32-1" data-line-number="1">request.cookies.get(<span class="st">&#39;username&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb33-1" data-line-number="1">resp <span class="op">=</span> make_response(render_template(...))</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">resp.set_cookie(<span class="st">&#39;username&#39;</span>, <span class="st">&#39;the username&#39;</span>)</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#cookies" class="uri">http://flask.pocoo.org/docs/0.12/quickstart/#cookies</a></li>
</ul>
</div>
<h2 id="http-methods">HTTP Methods</h2>
<dl>
<dt>OPTIONS</dt>
<dd>Starting with Flask 0.6, this is implemented for you automatically.
</dd>
</dl>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#http-methods" class="uri">http://flask.pocoo.org/docs/0.12/quickstart/#http-methods</a></li>
</ul>
</div>
<h2 id="message-flashing">Message Flashing</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb34-1" data-line-number="1">flash(<span class="st">&#39;You were successfully logged in&#39;</span>)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="cf">return</span> redirect(url_for(<span class="st">&#39;index&#39;</span>))</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="at">@app.route</span>(<span class="st">&#39;/&#39;</span>)</a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="kw">def</span> index():</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">    <span class="cf">return</span> render_template(<span class="st">&#39;index.html&#39;</span>)</a></code></pre></div>
<p>The template cotains following code:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb35-1" data-line-number="1">{% with messages = get_flashed_messages() %}</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/patterns/flashing/#message-flashing-pattern" class="uri">http://flask.pocoo.org/docs/0.12/patterns/flashing/#message-flashing-pattern</a></li>
</ul>
</div>
<h2 id="redirects-and-errors">Redirects and Errors</h2>
<ul>
<li>Exceptions generated by flask are subclasses of <code>werkzeug.exceptions.HTTPException</code></li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="im">from</span> flask <span class="im">import</span> abort, redirect, render_template, url_for</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="at">@app.route</span>(<span class="st">&#39;/&#39;</span>)</a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="kw">def</span> index():</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">    <span class="cf">return</span> redirect(url_for(<span class="st">&#39;login&#39;</span>))</a>
<a class="sourceLine" id="cb36-6" data-line-number="6"></a>
<a class="sourceLine" id="cb36-7" data-line-number="7"><span class="at">@app.route</span>(<span class="st">&#39;/login&#39;</span>)</a>
<a class="sourceLine" id="cb36-8" data-line-number="8"><span class="kw">def</span> login():</a>
<a class="sourceLine" id="cb36-9" data-line-number="9">    abort(<span class="dv">401</span>)</a>
<a class="sourceLine" id="cb36-10" data-line-number="10">    this_is_never_executed()</a>
<a class="sourceLine" id="cb36-11" data-line-number="11"></a>
<a class="sourceLine" id="cb36-12" data-line-number="12"><span class="at">@app.errorhandler</span>(<span class="dv">404</span>)</a>
<a class="sourceLine" id="cb36-13" data-line-number="13"><span class="kw">def</span> page_not_found(error):</a>
<a class="sourceLine" id="cb36-14" data-line-number="14">    <span class="cf">return</span> render_template(<span class="st">&#39;page_not_found.html&#39;</span>), <span class="dv">404</span></a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/1.0/quickstart/#redirects-and-errors" class="uri">http://flask.pocoo.org/docs/1.0/quickstart/#redirects-and-errors</a></li>
<li><a href="http://werkzeug.pocoo.org/docs/0.14/exceptions/" class="uri">http://werkzeug.pocoo.org/docs/0.14/exceptions/</a></li>
</ul>
</div>
<h2 id="request-context">Request Context</h2>
<ul>
<li>The request context internally works like a stack</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">def</span> wsgi_app(<span class="va">self</span>, environ):</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">    <span class="cf">with</span> <span class="va">self</span>.request_context(environ):</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">        <span class="cf">try</span>:</a>
<a class="sourceLine" id="cb37-4" data-line-number="4">            response <span class="op">=</span> <span class="va">self</span>.full_dispatch_request()</a>
<a class="sourceLine" id="cb37-5" data-line-number="5">        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</a>
<a class="sourceLine" id="cb37-6" data-line-number="6">            response <span class="op">=</span> <span class="va">self</span>.make_response(<span class="va">self</span>.handle_exception(e))</a>
<a class="sourceLine" id="cb37-7" data-line-number="7">        <span class="cf">return</span> response(environ, start_response)</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/reqcontext/" class="uri">http://flask.pocoo.org/docs/0.12/reqcontext/</a></li>
</ul>
</div>
<h2 id="responses">Responses</h2>
<ol>
<li>response object :: just return</li>
<li>string :: create a response object with it</li>
<li>tuple :: <code>(response, status, headers)</code> or <code>(response, headers)</code>, <code>headers</code> can be a <code>list</code> or a <code>dict</code>.</li>
<li>WSGI application :: covert it to a response object.</li>
</ol>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#about-responses" class="uri">http://flask.pocoo.org/docs/0.12/quickstart/#about-responses</a></li>
</ul>
</div>
<h2 id="routing">Routing</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="at">@app.route</span>(<span class="st">&#39;/&#39;</span>)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">def</span> index():</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">    <span class="cf">pass</span></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"></a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="at">@app.route</span>(<span class="st">&#39;/hello&#39;</span>)</a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="kw">def</span> hello():</a>
<a class="sourceLine" id="cb38-7" data-line-number="7">    <span class="cf">pass</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="at">@app.route</span>(<span class="st">&#39;/user/&lt;username&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb38-10" data-line-number="10"><span class="kw">def</span> show_user_profile(username):</a>
<a class="sourceLine" id="cb38-11" data-line-number="11">    <span class="cf">pass</span></a>
<a class="sourceLine" id="cb38-12" data-line-number="12"></a>
<a class="sourceLine" id="cb38-13" data-line-number="13"><span class="at">@app.route</span>(<span class="st">&#39;/post/&lt;int:post_id&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb38-14" data-line-number="14"><span class="kw">def</span> show_post(post_id):</a>
<a class="sourceLine" id="cb38-15" data-line-number="15">    <span class="cf">pass</span></a></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="at">@bp.route</span>(<span class="st">&#39;/&lt;user&gt;/&#39;</span>, defaults<span class="op">=</span>{<span class="st">&#39;name&#39;</span>: <span class="va">None</span>})</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="at">@bp.route</span>(<span class="st">&#39;/&lt;user&gt;/&lt;path:name&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="kw">def</span> query(user, name):</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">    <span class="cf">pass</span></a></code></pre></div>
<p>Trailing slashs:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="at">@app.route</span>(<span class="st">&#39;/projects/&#39;</span>)</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw">def</span> projects():</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">    <span class="cf">return</span> <span class="st">&#39;The project page&#39;</span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"></a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="at">@app.route</span>(<span class="st">&#39;/about&#39;</span>)</a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="kw">def</span> about():</a>
<a class="sourceLine" id="cb40-7" data-line-number="7">    <span class="cf">return</span> <span class="st">&#39;The about page&#39;</span></a></code></pre></div>
<dl>
<dt>routes defined with trailing slash</dt>
<dd><code>/projects</code> is redirected to <code>/projects/</code>
</dd>
<dt>routes defined without trailing slash</dt>
<dd><code>/about/</code> goes to <code>404</code>
</dd>
<dt><code>/test/&lt;path:code&gt;</code></dt>
<dd>`code` can include <code>/</code>
</dd>
</dl>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#url-route-registrations" class="uri">http://flask.pocoo.org/docs/0.12/api/#url-route-registrations</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#routing" class="uri">http://flask.pocoo.org/docs/0.12/quickstart/#routing</a></li>
<li><a href="http://flask.pocoo.org/snippets/76/" class="uri">http://flask.pocoo.org/snippets/76/</a></li>
</ul>
</div>
<h2 id="sessions">Sessions</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/22463939/demystify-flask-app-secret-key">How SECRET<sub>KEY</sub> works</a></li>
</ul>
<blockquote>
<p>The way Flask does this is by using a signed cookie.</p>
</blockquote>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="im">from</span> flask <span class="im">import</span> Flask, session, redirect, url_for, escape, request</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"></a>
<a class="sourceLine" id="cb41-3" data-line-number="3">app <span class="op">=</span> Flask(<span class="va">__name__</span>)</a>
<a class="sourceLine" id="cb41-4" data-line-number="4"></a>
<a class="sourceLine" id="cb41-5" data-line-number="5"><span class="at">@app.route</span>(<span class="st">&#39;/&#39;</span>)</a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="kw">def</span> index():</a>
<a class="sourceLine" id="cb41-7" data-line-number="7">    <span class="cf">if</span> <span class="st">&#39;username&#39;</span> <span class="kw">in</span> session:</a>
<a class="sourceLine" id="cb41-8" data-line-number="8">        <span class="cf">return</span> <span class="st">&#39;Logged in as </span><span class="sc">%s</span><span class="st">&#39;</span> <span class="op">%</span> escape(session[<span class="st">&#39;username&#39;</span>])</a>
<a class="sourceLine" id="cb41-9" data-line-number="9">    <span class="cf">return</span> <span class="st">&#39;You are not logged in&#39;</span></a>
<a class="sourceLine" id="cb41-10" data-line-number="10"></a>
<a class="sourceLine" id="cb41-11" data-line-number="11"><span class="co"># set the secret key.  keep this really secret:</span></a>
<a class="sourceLine" id="cb41-12" data-line-number="12">app.secret_key <span class="op">=</span> <span class="st">&#39;A0Zr98j/3yX R~XHH!jmN]LWX/,?RT&#39;</span></a></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="at">@app.before_request</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw">def</span> make_session_permanent():</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">    session.permanent <span class="op">=</span> <span class="va">True</span></a></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> os</a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="op">&gt;&gt;&gt;</span> os.urandom(<span class="dv">24</span>)</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="co">&#39;\xfd{H\xe5&lt;\x95\xf9\xe3\x96.5\xd1\x01O&lt;!\xd5\xa2\xa0\x9fR&quot;\xa1\xa8&#39;</span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"></a>
<a class="sourceLine" id="cb43-5" data-line-number="5">Just take that thing <span class="kw">and</span> copy<span class="op">/</span>paste it into your code <span class="kw">and</span> you<span class="st">&#39;re done.</span></a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#sessions" class="uri">http://flask.pocoo.org/docs/0.12/quickstart/#sessions</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#sessions" class="uri">http://flask.pocoo.org/docs/0.12/api/#sessions</a></li>
<li><a href="https://stackoverflow.com/questions/34118093/flask-permanent-session-where-to-define-them" class="uri">https://stackoverflow.com/questions/34118093/flask-permanent-session-where-to-define-them</a></li>
</ul>
</div>
<h2 id="signals">Signals</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="im">from</span> flask <span class="im">import</span> template_rendered</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="im">from</span> contextlib <span class="im">import</span> contextmanager</a>
<a class="sourceLine" id="cb44-3" data-line-number="3"></a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="at">@contextmanager</span></a>
<a class="sourceLine" id="cb44-5" data-line-number="5"><span class="kw">def</span> captured_templates(app):</a>
<a class="sourceLine" id="cb44-6" data-line-number="6">    recorded <span class="op">=</span> []</a>
<a class="sourceLine" id="cb44-7" data-line-number="7">    <span class="kw">def</span> record(sender, template, context, <span class="op">**</span>extra):</a>
<a class="sourceLine" id="cb44-8" data-line-number="8">        recorded.append((template, context))</a>
<a class="sourceLine" id="cb44-9" data-line-number="9">    template_rendered.<span class="ex">connect</span>(record, app)</a>
<a class="sourceLine" id="cb44-10" data-line-number="10">    <span class="cf">try</span>:</a>
<a class="sourceLine" id="cb44-11" data-line-number="11">        <span class="cf">yield</span> recorded</a>
<a class="sourceLine" id="cb44-12" data-line-number="12">    <span class="cf">finally</span>:</a>
<a class="sourceLine" id="cb44-13" data-line-number="13">        template_rendered.disconnect(record, app)</a></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="cf">with</span> captured_templates(app) <span class="im">as</span> templates:</a>
<a class="sourceLine" id="cb45-2" data-line-number="2">    rv <span class="op">=</span> app.test_client().get(<span class="st">&#39;/&#39;</span>)</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">    <span class="cf">assert</span> rv.status_code <span class="op">==</span> <span class="dv">200</span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4">    <span class="cf">assert</span> <span class="bu">len</span>(templates) <span class="op">==</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb45-5" data-line-number="5">    template, context <span class="op">=</span> templates[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb45-6" data-line-number="6">    <span class="cf">assert</span> template.name <span class="op">==</span> <span class="st">&#39;index.html&#39;</span></a>
<a class="sourceLine" id="cb45-7" data-line-number="7">    <span class="cf">assert</span> <span class="bu">len</span>(context[<span class="st">&#39;items&#39;</span>]) <span class="op">==</span> <span class="dv">10</span></a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="im">from</span> flask <span class="im">import</span> template_rendered</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="at">@template_rendered.connect_via</span>(app)</a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="kw">def</span> when_template_rendered(sender, template, context, <span class="op">**</span>extra):</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">    <span class="bu">print</span> <span class="st">&#39;Template </span><span class="sc">%s</span><span class="st"> is rendered with </span><span class="sc">%s</span><span class="st">&#39;</span> <span class="op">%</span> (template.name, context)</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/signals/" class="uri">http://flask.pocoo.org/docs/0.12/signals/</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/api/#core-signals-list" class="uri">http://flask.pocoo.org/docs/0.12/api/#core-signals-list</a></li>
<li><a href="http://pythonhosted.org/blinker/#blinker.base.Signal.connect_via" class="uri">http://pythonhosted.org/blinker/#blinker.base.Signal.connect_via</a></li>
</ul>
</div>
<h2 id="static-files">Static Files</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb47-1" data-line-number="1">url_for(<span class="st">&#39;static&#39;</span>, filename<span class="op">=</span><span class="st">&#39;style.css&#39;</span>)</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#static-files" class="uri">http://flask.pocoo.org/docs/0.12/quickstart/#static-files</a></li>
</ul>
</div>
<h2 id="templates">Templates</h2>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/templating/" class="uri">http://flask.pocoo.org/docs/0.12/templating/</a></li>
</ul>
</div>
<h3 id="standard-contexts">Standard Contexts</h3>
<ul>
<li><code>config</code></li>
<li><code>request</code></li>
<li><code>session</code></li>
<li><code>g</code></li>
<li><code>url_for</code></li>
</ul>
<h3 id="tojson">tojson</h3>
<p><code>tojson()</code>: This function converts the given object into JSON representation.</p>
<blockquote>
<p>Note that inside <code>script</code> tags no escaping must take place, so make sure to disable escaping with <code>|safe</code> before Flask 0.10 if you intend to use it inside <code>script</code> tags:</p>
</blockquote>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="op">&lt;</span>script <span class="bu">type</span><span class="op">=</span>text<span class="op">/</span>javascript<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2">    doSomethingWith({{ user.username<span class="op">|</span>tojson<span class="op">|</span>safe }})<span class="op">;</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="op">&lt;/</span>script<span class="op">&gt;</span></a></code></pre></div>
<h1 id="patterns">Patterns</h1>
<h2 id="application-factories">Application Factories</h2>
<ul>
<li>More flexible, more organized, but more complicated</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">def</span> create_app(config_filename):</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">    app <span class="op">=</span> Flask(<span class="va">__name__</span>)</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">    app.config.from_pyfile(config_filename)</a>
<a class="sourceLine" id="cb49-4" data-line-number="4"></a>
<a class="sourceLine" id="cb49-5" data-line-number="5">    <span class="im">from</span> yourapplication.model <span class="im">import</span> db</a>
<a class="sourceLine" id="cb49-6" data-line-number="6">    db.init_app(app)</a>
<a class="sourceLine" id="cb49-7" data-line-number="7"></a>
<a class="sourceLine" id="cb49-8" data-line-number="8">    <span class="im">from</span> yourapplication.views.admin <span class="im">import</span> admin</a>
<a class="sourceLine" id="cb49-9" data-line-number="9">    <span class="im">from</span> yourapplication.views.frontend <span class="im">import</span> frontend</a>
<a class="sourceLine" id="cb49-10" data-line-number="10">    app.register_blueprint(admin)</a>
<a class="sourceLine" id="cb49-11" data-line-number="11">    app.register_blueprint(frontend)</a>
<a class="sourceLine" id="cb49-12" data-line-number="12"></a>
<a class="sourceLine" id="cb49-13" data-line-number="13">    <span class="cf">return</span> app</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/patterns/appfactories/" class="uri">http://flask.pocoo.org/docs/0.12/patterns/appfactories/</a></li>
</ul>
</div>
<h1 id="extensions">Extensions</h1>
<h2 id="flask-cors">flask-cors</h2>
<p>The settings for CORS are determined in the following order</p>
<ol>
<li>Resource level settings (e.g when passed as a dictionary)</li>
<li>Keyword argument settings</li>
<li>App level configuration settings (e.g. CORS<sub>*</sub>)</li>
<li>Default settings</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="im">from</span> flask <span class="im">import</span> Flask</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="im">from</span> flask_cors <span class="im">import</span> CORS</a>
<a class="sourceLine" id="cb50-3" data-line-number="3"></a>
<a class="sourceLine" id="cb50-4" data-line-number="4">app <span class="op">=</span> Flask(<span class="va">__name__</span>)</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">CORS(app, resources<span class="op">=</span>{<span class="vs">r&quot;/api/*&quot;</span>: {<span class="st">&quot;origins&quot;</span>: <span class="st">&quot;*&quot;</span>}})</a>
<a class="sourceLine" id="cb50-6" data-line-number="6"></a>
<a class="sourceLine" id="cb50-7" data-line-number="7"><span class="at">@app.route</span>(<span class="st">&quot;/api/v1/users&quot;</span>)</a>
<a class="sourceLine" id="cb50-8" data-line-number="8"><span class="kw">def</span> list_users():</a>
<a class="sourceLine" id="cb50-9" data-line-number="9">  <span class="cf">return</span> <span class="st">&quot;user example&quot;</span></a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://github.com/corydolphin/flask-cors" class="uri">https://github.com/corydolphin/flask-cors</a></li>
<li><a href="https://flask-cors.corydolphin.com/en/latest/api.html#extension" class="uri">https://flask-cors.corydolphin.com/en/latest/api.html#extension</a></li>
</ul>
</div>
</article>

</body>
</html>
