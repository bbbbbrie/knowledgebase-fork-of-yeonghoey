<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120656861-1"></script>
  <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
   gtag('config', 'UA-120656861-1');
  </script>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />


  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#00aba9">
  <meta name="theme-color" content="#ffffff">

  <title>STAT 420: Week 2</title>

  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>

  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <link rel="stylesheet" href="/_css/content.css" />


  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->

  <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed|Roboto+Mono" rel="stylesheet">
</head>
<body>
<nav class="menu">
  <ol class="breadcrumb">
    <li><a href="/" >Home</a></li>
    <li><a href="/mcs-ds/" >mcs-ds</a></li>
    <li><a href="/mcs-ds/stat-420/" >stat-420</a></li>
    <li>week-02</li>
  </ol>
</nav>

<article>
<header>
<h1 class="title">STAT 420: Week 2</h1>
</header>

<nav class="toc">
<h2>Table of Contents</h2>
<ul>
<li><a href="#simple-linear-regression">Simple Linear Regression</a><ul>
<li><a href="#models">Models</a></li>
<li><a href="#fitting-a-line">Fitting a Line</a></li>
<li><a href="#simple-linear-regression-model">Simple Linear Regression Model</a></li>
</ul></li>
<li><a href="#the-normal-distribution">The Normal Distribution</a><ul>
<li><a href="#normal-distribution">Normal Distribution</a></li>
<li><a href="#normal-distribution-in-r">Normal Distribution in R</a></li>
</ul></li>
<li><a href="#slr-details">SLR Details</a><ul>
<li><a href="#estimation">Estimation</a></li>
<li><a href="#variance-decomposition">Variance Decomposition</a></li>
<li><a href="#maximum-likelihood">Maximum Likelihood</a></li>
<li><a href="#the-lm-function">The lm() Function</a></li>
</ul></li>
<li><a href="#slr-in-r">SLR in R</a><ul>
<li><a href="#simulation">Simulation</a></li>
<li><a href="#simulating-slr-in-r">Simulating SLR in R</a></li>
</ul></li>
</ul>
</nav>

<h1 id="simple-linear-regression">Simple Linear Regression</h1>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html" class="uri">http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html</a></li>
</ul>
</div>
<h2 id="models">Models</h2>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_16-43-40.png" /></p>
<ul>
<li>Predictor and Response</li>
</ul>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_16-44-57.png" /></p>
<ul>
<li>Overfit and Underfit</li>
</ul>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_16-48-15.png" /></p>
<blockquote>
<p>All models are wrong; some models are useful. â€” George E. P. Box</p>
</blockquote>
<h2 id="fitting-a-line">Fitting a Line</h2>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_16-54-45.png" /></p>
<ol>
<li>Minimize the maximum error</li>
<li>Minimize the abs value of errors</li>
<li>Minimize the squared errors. This is easier to calculate beta than others.</li>
</ol>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_16-56-42.png" /></p>
<ul>
<li>Note that <code>f(b0, b1)</code> is convex. (<a href="https://math.stackexchange.com/questions/483339/proof-of-convexity-of-linear-least-squares">note1</a>, <a href="https://en.wikipedia.org/wiki/Derivative_test#Second_derivative_test_(single_variable)">note2</a>)</li>
</ul>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_16-56-49.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/solve-least-squares1.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/solve-least-squares2.png" /></p>
<p>This is because:</p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/solve-least-squares3.png" /></p>
<p>So,</p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/solve-least-squares4.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/interpretation.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_17-18-23.png" /></p>
<ul>
<li>Interpolation and Extrapolation</li>
<li>The further we get away from the dataset, the less confident we are in our fitted model.</li>
</ul>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html#least-squares-approach" class="uri">http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html#least-squares-approach</a></li>
</ul>
</div>
<h2 id="simple-linear-regression-model">Simple Linear Regression Model</h2>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_17-26-37.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_17-27-45.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_17-29-40.png" /></p>
<ul>
<li>Linear</li>
<li>Independent</li>
<li>Normal</li>
<li>Equal Variance</li>
</ul>
<h1 id="the-normal-distribution">The Normal Distribution</h1>
<h2 id="normal-distribution">Normal Distribution</h2>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_17-33-14.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_17-35-50.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_17-38-24.png" /></p>
<h2 id="normal-distribution-in-r">Normal Distribution in R</h2>
<dl>
<dt><code>dnrom</code></dt>
<dd><code>d</code> stands for <strong>density</strong> (PDF)
</dd>
<dt><code>pnorm</code></dt>
<dd><code>p</code> stands for <strong>probability</strong> (CDF)
</dd>
</dl>
<div class="sourceCode" id="cb1" data-org-language="R" data-results="output" data-exports="both"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">diff</span>(<span class="kw">pnorm</span>(<span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">115</span>), <span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">15</span>))</a></code></pre></div>
<pre class="example"><code>[1] 0.3413447
</code></pre>
<div class="sourceCode" id="cb3" data-org-language="R" data-results="output" data-exports="both"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">pnorm</span>(<span class="dv">130</span>, <span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">15</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre class="example"><code>[1] 0.02275013
</code></pre>
<div class="sourceCode" id="cb5" data-org-language="R" data-results="output" data-exports="both"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">qnorm</span>(<span class="fl">0.95</span>, <span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">15</span>)</a></code></pre></div>
<pre class="example"><code>[1] 124.6728
</code></pre>
<div class="sourceCode" id="cb7" data-org-language="R" data-results="output" data-exports="both"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">pnorm</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">mean =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">sd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co"># Equivalant to above</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw">pnorm</span>(<span class="fl">0.5</span>, <span class="dt">mean =</span> <span class="dv">-1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw">pnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw">pnorm</span>(<span class="dv">0</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<pre class="example"><code>[1] 0.77337265 0.84134475 0.02275013
[1] 0.7733726
[1] 0.8413447
[1] 0.02275013
</code></pre>
<h1 id="slr-details">SLR Details</h1>
<h2 id="estimation">Estimation</h2>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-27-20.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-28-43.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-31-30.png" /></p>
<ul>
<li>As the general sample variance is divided by <code>(n - 1)</code>, the estimated variance should be divided by <code>(n - 2)</code>, since there are two variables(<code>b0</code>, <code>b1</code>)</li>
</ul>
<h2 id="variance-decomposition">Variance Decomposition</h2>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-38-33.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/variance-decomposition.png" /></p>
<p>This is true. This can be proven by using the fact that sum of the residuals are zero (<a href="https://autarkaw.org/2017/07/06/sum-of-the-residuals-for-the-linear-regression-model-is-zero/">proof</a>)</p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-24_20-50-34.png" /> (<a href="https://www.xycoon.com/decom1.htm">link1</a>) (<a href="https://www.xycoon.com/decom2.htm">link2</a>)</p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-39-29.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-40-15.png" /></p>
<p>For the <code>cars</code> example, we calculate <code>R^2 = 0.65</code>, We then say that <code>65%</code> of the observed variability in stopping distance is explained by the linear relationship with speed.</p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-46-39.png" /></p>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://en.wikipedia.org/wiki/Coefficient_of_determination" class="uri">https://en.wikipedia.org/wiki/Coefficient_of_determination</a></li>
</ul>
</div>
<h2 id="maximum-likelihood">Maximum Likelihood</h2>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-24_21-00-09.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-50-54.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/mle.png" /></p>
<p>The first two equations above are the same as least squares.</p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/least-squares-mle.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-51-14.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_19-52-32.png" /></p>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html#maximum-likelihood-estimation-mle-approach" class="uri">http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html#maximum-likelihood-estimation-mle-approach</a></li>
</ul>
</div>
<h2 id="the-lm-function">The lm() Function</h2>
<ul>
<li><code>lm()</code> stands for <code>linear model</code>.</li>
</ul>
<div class="sourceCode" id="cb9" data-org-language="R"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">stop_dist_model =<span class="st"> </span><span class="kw">lm</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">plot</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">     <span class="dt">xlab =</span> <span class="st">&quot;Speed (in Miles Per Hour)&quot;</span>,</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">     <span class="dt">ylab =</span> <span class="st">&quot;Stopping Distance (in Feet)&quot;</span>,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">     <span class="dt">main =</span> <span class="st">&quot;Stopping Distance vs Speed&quot;</span>,</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">     <span class="dt">pch  =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">     <span class="dt">cex  =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">     <span class="dt">col  =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="kw">abline</span>(stop_dist_model, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;darkorange&quot;</span>)</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="kw">coef</span>(stop_dist_model)</a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="kw">resid</span>(stop_dist_model)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="kw">fitted</span>(stop_dist_model)</a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="kw">summary</span>(stop_dist_model)</a>
<a class="sourceLine" id="cb9-16" data-line-number="16"></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="kw">predict</span>(stop_dist_model, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">speed =</span> <span class="dv">8</span>))</a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="kw">predict</span>(stop_dist_model, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">speed =</span> <span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">21</span>, <span class="dv">50</span>)))</a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="kw">predict</span>(stop_dist_model)</a></code></pre></div>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html#the-lm-function" class="uri">http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html#the-lm-function</a></li>
</ul>
</div>
<h1 id="slr-in-r">SLR in R</h1>
<h2 id="simulation">Simulation</h2>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_20-17-43.png" /></p>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/screenshot_2018-05-21_20-21-07.png" /></p>
<h2 id="simulating-slr-in-r">Simulating SLR in R</h2>
<div class="sourceCode" id="cb10" data-org-language="R" data-results="output" data-exports="both"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">num_obs =<span class="st"> </span><span class="dv">21</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">(<span class="dt">x_vals =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">length.out =</span> num_obs))</a></code></pre></div>
<pre class="example"><code> [1]  0.0  0.5  1.0  1.5  2.0  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0
[16]  7.5  8.0  8.5  9.0  9.5 10.0
</code></pre>
<div class="sourceCode" id="cb12" data-org-language="R" data-results="output" data-exports="both"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">num_obs =<span class="st"> </span><span class="dv">21</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">sigma =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">(<span class="dt">epsilon =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> num_obs, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sigma))</a></code></pre></div>
<pre class="example"><code> [1] -1.87936143  0.55092997 -2.50688584  4.78584241  0.98852332 -2.46140515
 [7]  1.46228716  2.21497412  1.72734405 -0.91616516  4.53534351  1.16952971
[13] -1.86372174 -6.64409966  3.37479275 -0.13480083 -0.04857079  2.83150863
[19]  2.46366359  1.78170396  2.75693211
</code></pre>
<div class="sourceCode" id="cb14" data-org-language="R" data-file="_img/sim_slr.png" data-results="graphics" data-exports="both"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">num_obs =<span class="st"> </span><span class="dv">21</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">beta_<span class="dv">0</span>  =<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">beta_<span class="dv">1</span>  =<span class="st"> </span><span class="dv">-2</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">sigma   =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">x_vals =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">length.out =</span> num_obs)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"></a>
<a class="sourceLine" id="cb14-8" data-line-number="8">sim_slr =<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">beta_0 =</span> <span class="dv">10</span>, <span class="dt">beta_1 =</span> <span class="dv">5</span>, <span class="dt">sigma =</span> <span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">  n =<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">  epsilon =<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sigma)</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">  y =<span class="st"> </span>beta_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>beta_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>epsilon</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">  <span class="kw">data.frame</span>(<span class="dt">predictor =</span> x, <span class="dt">response =</span> y)</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb14-14" data-line-number="14"></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">sim_data =<span class="st"> </span><span class="kw">sim_slr</span>(<span class="dt">x =</span> x_vals, <span class="dt">beta_0 =</span> beta_<span class="dv">0</span>, <span class="dt">beta_1 =</span> beta_<span class="dv">1</span>, <span class="dt">sigma =</span> sigma)</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">sim_fit =<span class="st"> </span><span class="kw">lm</span>(response <span class="op">~</span><span class="st"> </span>predictor, <span class="dt">data =</span> sim_data)</a>
<a class="sourceLine" id="cb14-18" data-line-number="18"></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="kw">plot</span>(response <span class="op">~</span><span class="st"> </span>predictor, <span class="dt">data =</span> sim_data,</a>
<a class="sourceLine" id="cb14-20" data-line-number="20">     <span class="dt">xlab =</span> <span class="st">&quot;Simulated Predictor Variable&quot;</span>,</a>
<a class="sourceLine" id="cb14-21" data-line-number="21">     <span class="dt">ylab =</span> <span class="st">&quot;Simulated Response Variable&quot;</span>,</a>
<a class="sourceLine" id="cb14-22" data-line-number="22">     <span class="dt">main =</span> <span class="st">&quot;Simulated Regression Data&quot;</span>,</a>
<a class="sourceLine" id="cb14-23" data-line-number="23">     <span class="dt">pch  =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb14-24" data-line-number="24">     <span class="dt">cex  =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb14-25" data-line-number="25">     <span class="dt">col  =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="kw">abline</span>(sim_fit, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;darkorange&quot;</span>)</a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="kw">abline</span>(beta_<span class="dv">0</span>, beta_<span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>)</a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Truth&quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">lwd =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb14-29" data-line-number="29">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>))</a></code></pre></div>
<p><img src="https://media.yeonghoey.com/mcs-ds/stat-420/week-02/_img/sim_slr.png" /></p>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html#simulating-slr" class="uri">http://daviddalpiaz.github.io/appliedstats/simple-linear-regression.html#simulating-slr</a></li>
</ul>
</div>
</article>

</body>
</html>
